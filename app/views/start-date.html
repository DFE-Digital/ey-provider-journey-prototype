{% extends "layouts/main.html" %}

{% block pageTitle %}
  Question page template – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block beforeContent %}
<div class="govuk-phase-banner">
  <p class="govuk-phase-banner__content">
    <strong class="govuk-tag govuk-phase-banner__content__tag">
      PROTOTYPE
    </strong>
    <span class="govuk-phase-banner__text">
      This is not a real service
    </span>
  </p>
</div>

{{ govukBackLink({
  text: "Back",
  href: "javascript:window.history.back()"
}) }}
{% endblock %}

{% block content %}
<form class="form" method="post">
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset">
        <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
          <h1 class="govuk-fieldset__heading">
            When did {{ data['firstName'] }} start at {{ data['nurseryName'] }}?
          </h1>
        </legend>
        <div id="start-date-hint" class="govuk-hint">
          For example, 27 3 2007
        </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="start-day">
                Day
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="start-day" name="startDay" type="text" inputmode="numeric" value="{{ data['startDay'] }}">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="start-month">
                Month
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="start-month" name="startMonth" type="text" inputmode="numeric" value="{{ data['startMonth'] }}">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="start-year">
                Year
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="start-year" name="startYear" type="text" inputmode="numeric" value="{{ data['startYear'] }}">
            </div>
          </div>
        </form>
      </fieldset>
    </div>

    {{ govukButton({
      text: "Continue"
    }) }}

    {% set startDay = data['startDay'] %}
    {% set startMonth = data['startMonth'] %}
    {% set startYear = data['startYear'] %}

  </div>
</div>

<script>
  document.querySelector('form.form').addEventListener('submit', function(event) {
      // Prevent default form submission behavior
      event.preventDefault();

      // Extract start date values from form inputs
      const startDay = document.getElementById('start-day').value;
      const startMonth = document.getElementById('start-month').value;
      const startYear = document.getElementById('start-year').value;

      // Create a Date object from the extracted start date
      const startDate = new Date(`${startYear}-${startMonth}-${startDay}`);

      // Check if the start date is after 15 May 2024
      const eligibilityDate = new Date('2024-05-15');
      if (startDate > eligibilityDate) {
          // Randomly choose between /child-facing-A and /child-facing-B
          const nextPage = Math.random() < 0.5 ? '/child-facing-A' : '/child-facing-B';
          // Redirect to the randomly chosen page
          window.location.href = nextPage;
      } else {
          // Redirect to '/ineligible-start-date'
          window.location.href = '/ineligible-start-date';
      }
  });
</script>



{% endblock %}

